<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Summarizes and visualizes the pixel intensities per spot and channel — plotSpotHeatmap • imcRtools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Summarizes and visualizes the pixel intensities per spot and channel — plotSpotHeatmap"><meta property="og:description" content="Helper function for estimating the spillover matrix. This
function visualizes the median pixel intensities per spot (rows) and per
channel (columns) in form of a heatmap."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">imcRtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/imcRtools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/BodenmillerGroup/imcRtools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Summarizes and visualizes the pixel intensities per spot and channel</h1>
    <small class="dont-index">Source: <a href="https://github.com/BodenmillerGroup/imcRtools/blob/HEAD/R/plotSpotHeatmap.R" class="external-link"><code>R/plotSpotHeatmap.R</code></a></small>
    <div class="hidden name"><code>plotSpotHeatmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Helper function for estimating the spillover matrix. This
function visualizes the median pixel intensities per spot (rows) and per
channel (columns) in form of a heatmap.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">plotSpotHeatmap</span><span class="op">(</span>
  <span class="va">object</span>,
  spot_id <span class="op">=</span> <span class="st">"sample_id"</span>,
  channel_id <span class="op">=</span> <span class="st">"channel_name"</span>,
  assay_type <span class="op">=</span> <span class="st">"counts"</span>,
  statistic <span class="op">=</span> <span class="st">"median"</span>,
  log <span class="op">=</span> <span class="cn">TRUE</span>,
  threshold <span class="op">=</span> <span class="cn">NULL</span>,
  order_metals <span class="op">=</span> <span class="cn">TRUE</span>,
  color <span class="op">=</span> <span class="fu">viridis</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>,
  breaks <span class="op">=</span> <span class="cn">NA</span>,
  legend_breaks <span class="op">=</span> <span class="cn">NA</span>,
  cluster_cols <span class="op">=</span> <span class="cn">FALSE</span>,
  cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>a <code>SingleCellExperiment</code> object containing pixel
intensities per channel. Individual pixels are stored as columns and
channels are stored as rows.</p></dd>
<dt>spot_id</dt>
<dd><p>character string indicating which <code>colData(object)</code> entry
stores the isotope names of the spotted metal. Entries should be of the 
form (mt)(mass) (e.g. Sm152 for Samarium isotope with the atomic mass 152).</p></dd>
<dt>channel_id</dt>
<dd><p>character string indicating which <code>rowData(object)</code> 
entry contains the isotope names of the acquired channels.</p></dd>
<dt>assay_type</dt>
<dd><p>character string indicating which assay to use (default
<code>counts</code>).</p></dd>
<dt>statistic</dt>
<dd><p>the statistic to use when aggregating channels per spot
(default <code>median</code>)</p></dd>
<dt>log</dt>
<dd><p>should the aggregated pixel intensities be <code>log10(x + 1)</code> 
transformed?</p></dd>
<dt>threshold</dt>
<dd><p>single numeric indicating a threshold after pixel
aggregation. All aggregated values larger than <code>threshold</code> will be
labeled as <code>1</code>.</p></dd>
<dt>order_metals</dt>
<dd><p>should the metals be ordered based on spotted mass?</p></dd>
<dt>color</dt>
<dd><p>see parameter in <code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap</a></code></p></dd>
<dt>breaks</dt>
<dd><p>see parameter in <code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap</a></code></p></dd>
<dt>legend_breaks</dt>
<dd><p>see parameter in <code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap</a></code></p></dd>
<dt>cluster_cols</dt>
<dd><p>see parameter in <code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap</a></code></p></dd>
<dt>cluster_rows</dt>
<dd><p>see parameter in <code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap</a></code></p></dd>
<dt>...</dt>
<dd><p>other arguments passed to <code>pheatmap</code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>a <code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap</a></code> object</p>
    </div>
    <div id="quality-control-for-spillover-estimation">
    <h2>Quality control for spillover estimation</h2>
    

<p>Visualizing the aggregated pixel intensities serves two purposes:</p>
<ol><li><p>Small median pixel intensities (&lt; 200 counts) might hinder the robust
estimation of the channel spillover. In that case, consecutive pixels can be
summed (see <code><a href="binAcrossPixels.html">binAcrossPixels</a></code>).</p></li>
<li><p>Each spotted metal (row) should show the highest median pixel intensity
in its corresponding channel (column). If this is not the case, either the
naming of the .txt files was incorrect or the incorrect metal was spotted.</p></li>
</ol><p>By setting the <code>threshold</code> parameter, the user can easily identify spots
where pixel intensities are too low for robust spillover estimation.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap</a></code> for visual modifications</p>
<p><code><a href="https://rdrr.io/pkg/scuttle/man/aggregateAcrossCells.html" class="external-link">aggregateAcrossCells</a></code> for the aggregation
function</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Nils Eling (<a href="mailto:nils.eling@dqbm.uzh.ch">nils.eling@dqbm.uzh.ch</a>)</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/spillover"</span>, package <span class="op">=</span> <span class="st">"imcRtools"</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># Read in .txt files</span></span>
<span class="r-in"><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="readSCEfromTXT.html">readSCEfromTXT</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spotted channels:  Dy161, Dy162, Dy163, Dy164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Acquired channels:  Dy161, Dy162, Dy163, Dy164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Channels spotted but not acquired:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Channels acquired but not spotted:  </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Visualizes heatmap</span></span>
<span class="r-in"><span class="fu">plotSpotHeatmap</span><span class="op">(</span><span class="va">sce</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plotSpotHeatmap-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Visualizes thresholding results</span></span>
<span class="r-in"><span class="fu">plotSpotHeatmap</span><span class="op">(</span><span class="va">sce</span>, log <span class="op">=</span> <span class="cn">FALSE</span>, threshold <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plotSpotHeatmap-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nils Eling.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

