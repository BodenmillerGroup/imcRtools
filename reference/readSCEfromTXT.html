<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generates a SingleCellExperiment from .txt files — readSCEfromTXT • imcRtools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Generates a SingleCellExperiment from .txt files — readSCEfromTXT"><meta property="og:description" content='Helper function to process raw .txt files acquired by the
Hyperion imaging system into a SingleCellExperiment
object. This function is mainly used to read-in data generated from a
"spillover slide". Here, each .txt file contains the measurements of
multiple pixels for a single stain across all open channels.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">imcRtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.9.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/imcRtools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/BodenmillerGroup/imcRtools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generates a SingleCellExperiment from .txt files</h1>
    <small class="dont-index">Source: <a href="https://github.com/BodenmillerGroup/imcRtools/blob/HEAD/R/readSCEfromTXT.R" class="external-link"><code>R/readSCEfromTXT.R</code></a></small>
    <div class="hidden name"><code>readSCEfromTXT.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Helper function to process raw .txt files acquired by the
Hyperion imaging system into a <code><a href="https://rdrr.io/pkg/SingleCellExperiment/man/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a></code>
object. This function is mainly used to read-in data generated from a
"spillover slide". Here, each .txt file contains the measurements of
multiple pixels for a single stain across all open channels.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">readSCEfromTXT</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">".txt$"</span>,</span>
<span>  metadata_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Start_push"</span>, <span class="st">"End_push"</span>, <span class="st">"Pushes_duration"</span>, <span class="st">"X"</span>, <span class="st">"Y"</span>, <span class="st">"Z"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  read_metal_from_filename <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>input can be of different types:</p><dl><dt>A path</dt>
<dd><p>Full path to where the single stain .txt files are located.</p></dd>

<dt>A list object</dt>
<dd><p>A named list object where each entry is a
<code>data.frame</code> or coercible to one. The names of each entry indicate the
spotted metals (see details).</p></dd>


</dl></dd>


<dt>pattern</dt>
<dd><p>pattern to select which files should be read in (default
<code>".txt$"</code>). Only used when <code>x</code> is a path.</p></dd>


<dt>metadata_cols</dt>
<dd><p>character vector indicating which column entries of the
.txt files should be saved in the <code>colData(sce)</code> slot.</p></dd>


<dt>verbose</dt>
<dd><p>logical indicating if additional information regarding the
spotted and acquired masses should be shown.</p></dd>


<dt>read_metal_from_filename</dt>
<dd><p>should the sample metal and mass be extracted
from the file/object names?</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>returns a SCE object where pixels are stored as columns and acquired
channels are stored as rows.</p>
    </div>
    <div id="reading-in-txt-files-for-spillover-correction">
    <h2>Reading in .txt files for spillover correction</h2>
    


<p>As described in the original publication, single metal spots are acquired
using the Hyperion imaging system. Each acquisition corresponds to one spot.
All acquisitions are stored in a single .mcd file and individual acquisitions
are stored in single .txt files.</p>
<p>This function aggregates these measurements into a single
<code>SingleCellExperiment</code> object. For this, two inputs are possible:</p>
<ol><li><p><code>x</code> is a path:
By default all .txt files are read in from the specified path. Here, the path
should indicate the location of the spillover slide measurement. The file
names of the .txt file must contain the spotted metal isotope name in the
format <code>(mt)(mass)</code> (e.g. <code>Sm152</code> for Samarium isotope with the
atomic mass 152). Internally, the last occurrence of such a pattern is read
in as the metal isotope name and stored in the <code>colData(sce)$sample_id</code>
slot.</p></li>
<li><p><code>x</code> is a named list:
If there are issues with reading in the metal isotope names from the .txt
file names, the user can provide a list for which each entry contains the
contents of a single .txt file. The names of the list must indicate the
spotted metal in the format <code>(mt)(mass)</code>. These names will be stored in
the <code>colData(sce)$sample_id</code> slot.</p></li>
</ol><p>When <code>read_metal_from_filename = FALSE</code>, the function will not attempt
to read in the spotted metal isotopes from the file or list names. Therefore,
only the <code>sample_id</code> will be set based on the file/list names.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p><a href="https://www.sciencedirect.com/science/article/pii/S1550413118306910" class="external-link">Chevrier,
S. et al. 2017. “Compensation of Signal Spillover in Suspension and Imaging
Mass Cytometry.” Cell Systems 6: 612–20.</a></p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Nils Eling (<a href="mailto:nils.eling@dqbm.uzh.ch">nils.eling@dqbm.uzh.ch</a>)</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Read files from path</span></span></span>
<span class="r-in"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/spillover"</span>, package <span class="op">=</span> <span class="st">"imcRtools"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu">readSCEfromTXT</span><span class="op">(</span><span class="va">path</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spotted channels:  Dy161, Dy162, Dy163, Dy164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Acquired channels:  Dy161, Dy162, Dy163, Dy164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Channels spotted but not acquired:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Channels acquired but not spotted:  </span>
<span class="r-in"><span><span class="va">sce</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class: SingleCellExperiment </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dim: 4 400 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> metadata(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assays(1): counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rownames(4): 161Dy(Dy161Di) 162Dy(Dy162Di) 163Dy(Dy163Di)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   164Dy(Dy164Di)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rowData names(2): channel_name marker_name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colnames(400): Dy161.1 Dy161.2 ... Dy164.99 Dy164.100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colData names(9): Start_push End_push ... sample_metal sample_mass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reducedDimNames(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mainExpName: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> altExpNames(0):</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Read files as list</span></span></span>
<span class="r-in"><span><span class="va">cur_file_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">path</span>, pattern <span class="op">=</span> <span class="st">".txt"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cur_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">cur_file_names</span>, <span class="va">read.delim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cur_files</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">".txt"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">cur_file_names</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu">readSCEfromTXT</span><span class="op">(</span><span class="va">cur_files</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spotted channels:  Dy161, Dy162, Dy163, Dy164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Acquired channels:  Dy161, Dy162, Dy163, Dy164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Channels spotted but not acquired:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Channels acquired but not spotted:  </span>
<span class="r-in"><span><span class="va">sce</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class: SingleCellExperiment </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dim: 4 400 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> metadata(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assays(1): counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rownames(4): X161Dy.Dy161Di. X162Dy.Dy162Di. X163Dy.Dy163Di.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   X164Dy.Dy164Di.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rowData names(2): channel_name marker_name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colnames(400): Dy161.1 Dy161.2 ... Dy164.99 Dy164.100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colData names(9): Start_push End_push ... sample_metal sample_mass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reducedDimNames(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mainExpName: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> altExpNames(0):</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nils Eling.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

