---
title: "R Tools for IMC Data"
date: "`r BiocStyle::doc_date()`"
package: "`r BiocStyle::pkg_ver('imcRtools')`"
author:
- name: Nils Eling
  affiliation: 
  - Department for Quantitative Biomedicine, University of Zurich
  - Institute for Molecular Health Sciences, ETH Zurich
  email: nils.eling@dqbm.uzh.ch
- name: Tobias Hoch
  affiliation: 
  - Department for Quantitative Biomedicine, University of Zurich
  - Institute for Molecular Health Sciences, ETH Zurich
output:
    BiocStyle::html_document:
        toc_float: yes
bibliography: library.bib
abstract: |
    Abstract
vignette: |
    %\VignetteIndexEntry{"R Tools for IMC Data}
    %\VignetteEngine{knitr::rmarkdown}
    %\VignetteEncoding{UTF-8}
---

```{r, echo=FALSE, results="hide"}
knitr::opts_chunk$set(error=FALSE, warning=FALSE, message=FALSE,
                        fig.retina = 0.75, crop = NULL)
library(BiocStyle)
```

```{r library, echo=FALSE}
library(imcRtools)
```

# Introduction

This vignette gives an introduction to the `imcRtools` package.

## Imaging mass cytometry

# Example data

The `imcRtools` package contains a number of example data generated by the
Hyperion imaging system for different purposes. The following section gives an
overview of these files.

## For spillover correction

To highlight the use of the `imcRtools` package for spillover correction, 
we provied four .txt files containing pixel intensities of four spotted metals. 

# Read in single-cell features obtained from IMC data

## Read in CellProfiler output

## Read in steinbock output

# Spillover correction for IMC data

When acquiring IMC images, pixel intensities can be influenced by spillover 
from neighbouring channels. To correct for this, Chevrier _et al._ have 
developed a staining protocol to acquire individually spotted metal isotopes
[@Chevrier].
Based on these measurements, spillover into neighbouring channels can be
quantified and pixel intensities can be deconvolved into true and spillover
signal. 

The `imcRtools` package provides helper functions that facilitate the correction
of spillover for IMC data. For a full tutorial, please refer to the [IMC data analysis book](https://bodenmillergroup.github.io/IMCDataAnalysis/spillover-correction.html#ref-Chevrier2017).

## Read in the single-spot acquisition

In the first step, the pixel intensities of individually spotted metals need to 
be read into a `SingleCellExperiment` container for downstream use with the
`CATALYST` package. For this, the `readSCEfromTXT` function can be used:

```{r read-single-metals}
path <- system.file("extdata/spillover", package = "imcRtools")
sce <- readSCEfromTXT(path) 
sce
```

Here, the example metal spot files are read in. The spot information are stored
in the `colData(sce)` slot and channel information are stored in `rowData(sce)`.
Each column represents a single pixel.

## Perform quality checks

# Acknowledgements


# Contributions


# Session info {.unnumbered}

```{r sessionInfo, echo=FALSE}
sessionInfo()
```

# References
